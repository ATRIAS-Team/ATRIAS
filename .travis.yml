language: java
jdk: oraclejdk8
sudo: required # enabled 30/aug/18 due to travis issue #6593 causing failure
# addons:
#   apt:
#     packages:
#       - oracle-java8-installer  # https://github.com/travis-ci/travis-ci/issues/3259
before_install:
  # MATSim config
  #- cd $HOME && git clone --depth=1 --branch=kaibranch https://github.com/matsim-org/matsim.git
  #- cd $HOME/matsim && git checkout kaibranch && git log -1
  #- cd $HOME/matsim/examples && mvn clean install -DskipTests -Dmaven.test.skip -Dmaven.javadoc.skip -Dsource.skip -Dassembly.skipAssembly=true
  #- cd $HOME/matsim/matsim && mvn clean install -DskipTests -Dmaven.test.skip -Dmaven.javadoc.skip -Dsource.skip -Dassembly.skipAssembly=true
  #
  # Jill config
  #
  - cd $HOME && git clone --depth=1 --branch=dev https://github.com/agentsoz/jill.git
  - cd $HOME/jill && git checkout dev && git log -1
  #- cd $HOME/jill && git reset --hard 2510bed0037cc44520f2627ef85a4fee369e74a9 # fix commit to use
  - cd $HOME/jill && mvn clean install -N
  - cd $HOME/jill/jill && mvn clean install -DskipTests
  #
  # Diffusion Model config
  #
  - cd $HOME && git clone --depth=1 --branch=master https://github.com/agentsoz/diffusion-model.git
  - cd $HOME/diffusion-model && git log -1
  - cd $HOME/diffusion-model && mvn clean install -DskipTests
  #
  # BDI-ABM Integration config
  #
  - cd $HOME && git clone --depth=1 --branch=master https://github.com/agentsoz/bdi-abm-integration.git
  - cd $HOME/bdi-abm-integration && git log -1
  - cd $HOME/bdi-abm-integration && mvn clean install -N
  - cd $HOME/bdi-abm-integration/util && mvn clean install -DskipTests
  - cd $HOME/bdi-abm-integration/integrations/bdi-abm && mvn clean install -DskipTests
  - cd $HOME/bdi-abm-integration/integrations/abm-jill && mvn clean install -DskipTests
  - cd $HOME/bdi-abm-integration/integrations/bdi-matsim && mvn clean install -DskipTests

script:
  - cd $TRAVIS_BUILD_DIR && mvn package -B -Dmatsim.preferLocalDtds=true
# --fail-at-end # stop at first error --> easier to debug
# -Dmaven.test.redirectTestOutputToFile # otherwise nearly impossible to debug
env:
  global:
    - MAVEN_OPTS="-Xmx4g -Xms4g"
cache:
  directories:
  - $HOME/.m2
